# Restaurant_Review

## 호텔 뷔페 평가

- 서울 신라 호텔 뷔페 더 파크뷰 리뷰 평가

### 프로젝트 목적

- 호텔 뷔페 리뷰에 대한 평가 분석
  - 서울 신라호텔 더 파크뷰에 대한 사람들의 네이버 리뷰 평가 상세 분석

### 프로젝트 이유

- 리뷰는 주관적인 부분이 많기 때문에 사람들의 음식점에 대한 리뷰 평가가 더욱 다양해진다.
- 키워드에 따라 긍정/부정 평가가 많이 나뉘기 때문에 gpt를 이용한다면 키워드 마다 긍정/부정 평가를 많이 내릴 수 있다는 생각이 들었다.

### 프로젝트 계획

- 항상 만들어 놓은 최종 함수는 주피터 노트북 맨 위에 붙여둔다.
- 함수의 설명을 빼먹지 말자
- 많이 쓰이는 함수는 맨 위에다 두어 이용하기 쉽게 해놓는다.

#### 1.데이터 수집

- 서울 신라호텔 더 파크뷰에 대한 네이버 리뷰
- 리뷰를 얼마나 추출해야할까?
  - 200개에서 300개정도는 해야 어느 정도 윤곽이 잡히는 키워드들과 리뷰들에 대한 빅데이터를 가질 수 있다고 예상함
- 네이버 리뷰 링크를 주소로 사용하여 크롤링
  - 추출할 대상: 아이디, 리뷰 텍스트, 방문 날짜, 몇번째 방문
- 리뷰 텍스트가 전부 보이지 않는 경우가 있다.
  - 그 경우, 내용 더보기 버튼을 클릭하여 텍스트가 전부 다 보이게 한다.
  - for문을 돌려서 텍스트들을 추출할 때 try/except문을 써서 내용 더보기 버튼이 없는 리뷰에 예외처리를 해줘야한다.
- for문의 range를 19로 설정하면 원래 있었던 리뷰글 10개와 19번의 리뷰 더보기 버튼을 누름으로서 200개의 리뷰글이 보여야하지만 리뷰글이 210개가 보일 때도 있고 190개가 보일 때도 있음
- 페이지를 내렸을 때, 더보기 버튼을 눌러야 다른 리뷰 확인가능

---

#### 2. 데이터 전처리

- 전처리시 고려해야할 사항
  1. 특수문자, 한글 초성, 이모티콘 등의 제거
  2. 문장의 길이 -> 너무 짧던가 너무 길던가 그 중간의 이상치를 찾아 맞출 것인가
  3. 맞춤법 / 띄어쓰기

##### 1. 리뷰에 쓰여진 이모티콘 또는 감탄사 대신 쓰이는 초성 기호등을 제거

- 이유 : 리뷰에 쓰여지는 이모티콘 또는 초성기호 등은 사람들이 표현을 할 때 덧붙이는 또는 표현을 도와주는 것들이라 생각함.
  - 나중에 키워드들을 뽑을 때 이러한 표현들은 오히려 방해가 된다는 생각이 들기 때문에 제거해야 한다고 생각함.
- 개행문자 제거

##### 2. 맞춤법 / 띄어쓰기 확인

- 이유: 맞춤법같은 경우 나중에 키워드를 뽑을 때 같은 말이지만 맞춤법이 틀려 추출이 안되는 경우가 있을 수 있다.
  - 이러한 경우를 방지 하기 위해 맞춤법을 확인하는 작업이 필요하다고 생각함.
- 이유: 띄어쓰기도 맞춤법과 같은 경우라고 생각한다. 띄어쓰기는 잘못된 경우 다른 단어와 합쳐져 같은 키워드지만
  - 다른 표현으로 나오게 되어 키워드 의미가 중복될 수 있다고 생각하여 띄어쓰기 고치는 것도 필요한 작업이라 생각한다.
- 맞춤법 / 띄어쓰기 패키지인 hanspell / pykospacing 작동 ❌ -> 현재 작동 ✅
- hanspell 패키지를 이용해서 맞춤법 오류를 잡음
- 그러면서 생긴 리뷰글이 없는 행은 지움
- pykospacing 패키지를 이용해서 띄어쓰기가 안되어 있는 부분들을 찾아 고침
- 문제점 : spacing을 하니 한글자가 많이 생겨남

##### 2.5. 코드를 연습하는데 필요한 데이터 프레임 만들었음

##### 3. 문장의 길이 확인

- 우리는 리뷰들에 대한 긍정 / 부정 평가가 필요.
- 하지만 이를 하기 위해서는 의미가 있는 단어들을 추출하여 그것들의 긍/부정을 판별해야함.
- 문장(리뷰)의 길이가 길다면 긍/부정을 판단할 단어들보다 다른 단어들이 많이 나올 수 있음.
- 반대로 짧다면 다른 키워드들에 대한 긍/부정 판별할 수 있는 단어의 갯수가 적어 정확하지 않다고 생각함.
- 연구원님의 조언에 따라 `describe()` 또는 히스토그램을 사용해서 문장의 길이에 대한 이상치를 찾아야한다고 생각함.

- 이상치: 관측된 데이터의 범위에서 많이 벗어난 아주 작은 값이나 큰 값
- 이상치를 찾는 방법에는 기본적으로 여러가지가 있지만 그 중 2가지를 이용.
  - Z-Score와 IQR
- 그 중 IQR을 사용하여 이상치를 찾아 데이터프레임에서 제거함.
  - IQR을 사용한 이유는 Z-Score보다 좀 더 보편적이게 쓰이는 방법임.


##### 4. 불용어 처리
***불용어 처리를 하지 않겠음.***
- 리뷰에서는 자주 등장하지만 의미가 없는 단어들이 많이 없다고 생각한다.
- 다른 주제의 리뷰 또는 글에서는 의미가 없는 단어로 말을 길게 써놓은 경우가 많다.
- 하지만 음식점 리뷰에서는 서비스, 맛, 분위기등으로 평가를 한다. 서비스에서는 의미가 없는 단어일수 있지만, 분위기에서는 의미가 있는 단어일수도 있다는 생각이 든다.
- 이러한 경우 서비스에서 의미가 없다고 생각해 없애는 경우, 분위기에서의 평가가 사라지게 되므로 되도록 남겨두는 편이 좋다고 생각한다.

- 불용어의 의미:
  - 자주 등장하지만 의미 분석을 하는 것에 있어서는 큰 도움이 되지 않는 단어들

- 이 한글자를 제거하면 굿과같은 한글자지만 충분히 긍정의 의미를 나타내고 있는 것도 사라짐
- 굿을 예외 처리?!
- Chat GPT의 조언:
  - 의미 부족: 한 글자만 있는 리뷰는 일반적으로 의미 있는 정보를 전달하지 않습니다. 예를 들어, "좋" 또는 "나"와 같은 리뷰는 리뷰어의 감정이나 제품/서비스에 대한 평가를 충분히 전달하지 못합니다.
  - 노이즈 제거: 데이터 분석 및 모델 학습 과정에서 유의미한 정보를 제공하지 않는 데이터는 노이즈로 작용할 수 있습니다. 이러한 노이즈는 모델의 성능을 저하시킬 수 있습니다.
  - 데이터 품질 향상: 한 글자 리뷰를 제거함으로써 전체 데이터셋의 품질을 향상시킬 수 있습니다. 이는 더 정확한 분석 결과를 얻는 데 도움이 됩니다.

- 한글자들을 제거하여 데이터셋의 품질을 향상
  - 한글자 중에도 감성을 나타내는 단어가 있다.
  - 이를 제거하기보다는 하나의 판별 표현으로 보는 것이 더 낫다는 생각임.
- 나만의 불용어 사전(?)
- 불용어는 형태소로 나눈 뒤 삭제 /
- 형태소로 나누기 전 삭제

##### 5. 신조어 처리
***신조어 처리를 하지 않겠음***
- 이유 : 신조어처리는 당연히 어떤 글을 추출하든 필요하다고 생각한다.
- 하지만 음식점 리뷰 특성상 신조어를 많이 쓰는 경우가 없다고 생각함
- 신조어를 뽑을려고 한다면 나만의 신조어 사전을 만들어서 추출하여 사용하겠지만
- 내가 추출할려는 리뷰에는 신조어가 아직 없다고 생각함.
- 만약 형태소 분리를 통해 신조어가 보이게 되면 그때 당시 신조어 처리를 하겠음.

- 요즘 쓰이는 신조어는 형태소로 분리할 때 다르게 분리가 될 수도 있음.
- 또한 같은 뜻이지만 신조어로 쓰이는 경우엔 이해하지 못해 다르게 의미를 해석하는 경우가 있을 수 있음.
- 이를 예방하기 위해선 신조어 처리를 해야함.

- Soynlp 패키지를 사용하여 신조어 처리
- 하지만 새롭게 만들어진 미등록 단어들은 인식이 잘 되지 않는 단점을 가지고 있기 때문에 사용자 사전에 등록해야함.
- 문제점
  - 2022년 이후로 관리가 되어지지 않아 문제점이 많음.
  - 일단 실행이 되지만 구현이 안되는 것들이 있음.

---

#### 3. 데이터 분석

##### 1. 형태소 분리
  - 형태소 분리를 통해 명사, 형용사, 동사로 분리
  - 워드 클라우드 시각화를 통해 어떠한 단어들이 많이 분포되었는지 확인
  - 만약, 신조어 혹은 불용어로 보이는 것이 많이 보인다고 생각이 들면,
    - 데이터 전처리 과정으로 돌아가 신조어/ 불용어 처리를 한다.

- 형태소 분리를 `Okt`를 사용하여 명사, 형용사/동사 분리를 하였지만
- 작성자가 생각하는 명사뿐만 아니라 명사라고 보기 어려운 것도 같이 분류되어 시각화를 했을 때 다른 부분도 눈에 들어옴.
- 형용사/동사같은 경우 `맛있다`,`맛있어요`와 같이 똑같은 결의 단어가 나오게 되면서 분포도를 보여주는 워드클라우드의 의미가 흐려짐.

- 위와 같은 문제점/ 부족한점이 있어 `Kiwipiepy`를 사용하여 명사, 형용사/동사 분리를 하였음.
- `okt`보다 정확한 명사 분류가 시각화되었다고 생각함.
- 이를 통해 어떠한 명사들이 많이 쓰였는지 한 눈에 보임.
- 형용사/동사같은 경우 `맛있-`과 같은 중복적인 단어는 한가지로 통합되어 다른 형용사/동사들이 잘보이게 되었고 긍/부정평가에 대한 구분이 잘될거 같다고 예상함.

##### 2. 네이버 키워드 리뷰를 통해 '만족도', '맛', '서비스', '가격' 총 네가지로 나누어 긍정/부정 분류
- 4개의 카테고리로 나눠 분류한 이유:
  - 음식점 리뷰 댓글이라면 리뷰에 들어가는 키워드라면 맛, 서비스, 가격등이 들어간다고 생각했음.
  - 이후에 네이버 리뷰를 보니까 특징 키워드 칸이 있고 그 중에 맛, 서비스, 가격등이 들어가 있었음.
  - 음식점 리뷰에서 중요한 키워드는 만족도, 맛, 서비스, 가격으로 생각하고 네이버 리뷰 특징 키워드를 보니
  - 사람들이 제일 많이 남긴 키워드들과 거의 일치하여 4개의 키워드로 카테고리를 나눠 평가를 해야겠다고 생각함.

- 문제점 : 리뷰에 음식에 대한 평가에서 긍정과 부정이 한꺼번에 들어갈 수 있음을 인지함.
  - 이를 프롬프트로 고쳐 볼려고 했지만 프롬프트에 많은 일을 시키게 되면서 과부하 비슷한 일 발생
- 해결방법: 우리가 이 과제를 하는 이유중 하나는 스스로 작성해보며 포트폴리오를 만들기 위한 기초를 쌓는 중.
  - 이러한 문제점은 물론 고쳐야하지만 지금은 원래 잡았던 큰 목표를 이뤄야하기 때문에 프롬프트로 나눠지는 긍정/부정평가만 하기로 함.

- 프롬프트를 함수로 만들어 좀 더 간결하게 써볼려고 했음.
- 연구원님의 말씀에 따라 함수보단 클래스가 더 낫다는 말씀을 들어 클래스로 만들기로 함.

~~- 어려웠던점: 함수는 많이 만들어보았지만, 클래스는 만들어 본 횟수가 적어 chat gpt의 도움으로 만듦~~

##### 3. 긍정/부정으로 분류한 것을 그래프등으로 시각화하여 나타내기
- 각 카테고리별 긍/부정 확인
- 사람들이 리뷰글로 얼마나 많은 긍/부정 평가를 했는지 막대그래프를 사용하여 시각화
  - 그래프와 같은 시각화자료에는 제목을 달아주어 시각화자료가 어떠한 내용인지 바로 알 수 있도록 하자
- 이후 긍정이 가장 많은 카테고리가 무엇인지 확인/ 부정이 가장 많은 카테고리가 무엇인지 확인
  - 긍정이 가장 많은 카테고리는 `만족도`, 부정이 가장 많은 카테고리는 `가격`
  - 카테고리에 긍정인 리뷰글만 dataframe으로 추출, 카테고리에 부정인 리뷰글만 dataframe으로 추출
  - 각각의 dataframe들의 명사만을 추출하여 워드클라우드로 시각화
  - 명사만을 추출하여 시각화하여도 뜻을 어떻게 해석하느냐에 따라 의미가 달라질수 있다고 생각함.
  - 그래서 이러한 해석의 차이를 조금이라도 줄여보고자 동사/형용사도 추출하여 워드클라우드로 시각화

- `만족도`카테고리의 긍정글만 모아 명사, 동사/형용사를 추출하여 워드클라우드로 시각화한 결과
  - 눈에 띄는 점: 음식, 친절등의 명사 단어가 리뷰글에서 많이 나왔고, 이는 음식, 친절등에서 만족도가 많이 나왔을 확률이 크다고 예상함.
  - 동사/형용사 단어를 확인했을 때, 맛있다, 편하다등의 음식과 친절등에서 만족도가 많이 나왔다는 것을 뒷받침함.
  - 하지만 비싸다, 아쉽다등의 단어들이 확인이 되니 이는 가격이 비싸다 혹은 다른 키워드들이 아쉽다라는 예시로도 들 수 있음
  - 이로 인해, 만족도 부분에서는 긍정적인 평가를 할 수 있지만 동시에 다른 키워드인 가격, 맛, 서비스, 메뉴구성 등 다양한 부분에서 부정적인 평가도 같이 나온것을 확인 가능함.

- `가격`카테고리의 부정글만 모아 명사, 동사/형용사를 추출하여 워드클라우드로 시각화한 결과
  - 눈에 띄는 점: 음식, 친절등의 `만족도`카테고리의 워드클라우드랑 비슷한 단어들이 많이 분포되었지만 가격에 대한 얘기도 많이 나온게 확인됨.
    - 가격면에서는 부정적인 측면이 많았다고 볼 수 있지만, 가격이외 다른 카테고리에서는 긍정적인 측면이 많았다고 예상할 수 있음.
  - 동사/형용사를 확인했을 때 비싸다라는 가격에 대한 부정적인 말도 있지만 맛있다라는 키워드도 많았음.
    - 이는 가격면에서는 비쌌을수도 있지만, 다른 부분에서는 가격에 비해 괜찮았을 수도 있겠다는 예상을 할 수 있음.

- `만족도`,`가격`카테고리들의 긍정글, 부정글의 명사,동사/형용사를 확인하며 
  - 제일 많았던 긍정적인 단어들로는 맛있다, 음식, 친절등의 단어들을 통해 사람들이 만족하는 부분이 음식과 친절 혹은 서비스에서 만족도가 높았다고 예상할 수 있음.
  - 반면, 부정적인 리뷰들의 제일 많은 단어들은 맛있다, 음식, 친절등의 긍정적인 리뷰들과 똑같지만 다른 점은 가격, 비싸다등의 단어들이 긍정적인 리뷰 단어들보다 비중이 높게 나타났음.
  - 이는 긍정적이었던 리뷰들처럼 음식과 친절등에서 긍정적인 평가를 이뤄냈을수 있지만 이에 반해 가격면에서는 부정적인 평가를 이뤄냈다고 볼 수 있음.

- 문제점
  - `만족도` 긍정 리뷰글과 `가격` 부정 리뷰글의 워드클라우드들이 비슷한 이유
    - `만족도`의 긍정 평가는 171개의 리뷰글중 120개의 리뷰글이 `만족도`에 대한 긍정 리뷰글이었지만,
    - `가격`의 부정 평가는 171개의 리뷰글중 59개의 리뷰글이 `가격`에 대한 부정 리뷰글이었다.
  - 이러한 결과, `만족도`의 긍정 리뷰글은 전체 리뷰글의 반이상이고 `가격`의 부정 리뷰글은 전체 리뷰글의 1/3밖에 되지 않는다.
  - 그래서 `가격` 부정 리뷰글이 `만족도` 긍정 리뷰글과 겹치는 부분이 발생하게 된거 같다.
    - 워드 클라우드로 확인하게 되면 단어들의 분포가 많이 차이 나지 않는다.
    - 단어 중 가격, 비싸다, 맛있다 등 구분할 수 있는 주요한 키워드들이 비슷하게 나오게 되어 구분을 짓는게 어려워 졌다.
    - 다른 키워드의 부정 리뷰글을 할려고 해도 `가격` 부정 리뷰글에 비해 수가 터무니없이 적다.

- 해결방법
  - 크롤링할 리뷰글의 수를 늘리면 된다.
    - 만약 1000개를 했다는 가정하에 `만족도`에서 긍정 리뷰글이 800개가 나오고 `가격`에서 부정 리뷰글이 500개가 나오게 된다면
    - 그중 300 ~ 400개의 긍정 리뷰글, 부정 리뷰글을 뽑아서 쓰면 된다.
  - 긍정 리뷰글의 갯수와 부정 리뷰글의 갯수가 비슷한 카테고리끼리 비교를 한다.
    - 최고의 경우는 긍정 리뷰글과 부정 리뷰글이 겹치는 글이 많이 없을 때
    - 최악의 경우는 긍정 리뷰글과 부정 리뷰글이 겹치는 글이 많이 있을 때
    - 하지만 평가가 많은 키워드를 선택함으로써 데이터에 대한 신뢰가 올라가게 된다고 생각한다.
    - 평가가 작은 키워드를 선택하게 되면 데이터에 대한 신뢰가 떨어질 수 있지만 결과는 바뀔거라 생각한다.
- 데이터 분석하는 것은 있는 그대로의 데이터를 분석하면 되는 것이기에 결과에 상관없이 객관적으로 분석하면 된다고 생각한다.
- ~~하지만 만약 원하는 결과값을 도출하기 위한 데이터 분석이라면 데이터 표본을 건드릴 수도 있지 않을까 생각한다.~~
  - 해결방법에 대한 피드백(연구원님)
    - 가격 부정 리뷰 워드클라우드를 보면 디저트가 가장 크게 그려져 있다.
    - 워드클라우드로만 보면 가격에 부정인 사람들은 디저트를 만족했는가? 만족하지 않았는가?에 대한 의문이 생길 수 있을거 같다.
      - ex) 가격이 비싼만큼 디저트는 최고였어요 / 비쌌는데 생각보다 디저트가 별로였어요 등
    - 워드 클라우드뿐만 아니라 다른 방법이 있는지 더 고민을 하도록 한다.

- 워드 클라우드 이외의 데이터 시각화
  - 워드 클라우드 이외에 빈도 그래프, 막대 그래프, 트리맵등이 있다.
  - 하지만 워드클라우드만큼의 텍스트 데이터를 시각화 한것도 없고
  - 막대그래프 또는 트리맵의 경우 가지고 있는 데이터셋으로 효과적인 시각화를 기대하기 어렵다.

- 각 긍/부정 총 갯수를 구했으니 긍/부정 갯수의 비율을 구하자
  - 구해서 시각화함
  - 원래 생각했던 용도는 막대 그래프를 봐도 총 평가 갯수만 알지 긍/부정 갯수의 비율은 모르게 되니 구하였음.

- 각각 상위 3개의 명사들의 긍/부정을 확인하는 방법
- 상위 3개의 명사들의 긍/부정을 확인하게 되면 위의 연구원님 피드백에서 가격에 부정인 사람들은 디저트는 만족했는가/만족하지 못했는가에 대한 답을 알 수 있다.
- 워드클라우드에서 제일 크게 그려진 단어들중 하나이기에 구할 필요도 있다고 생각이 든다.
  - `만족도` 긍정 리뷰글중 제일 큰 명사 단어 3개
    - 디저트, 음식, 친절
  - `가격` 부정 리뷰글중 제일 큰 명사 단어 3개
    - 뷔페, 음식, 디저트
  - 고민 해볼 점:
    - csv파일을 각각 만들어서 만족도 리뷰글의 상위 3개의 명사를 담고 가격 리뷰글의 상위 3개의 명사를 담는다.
    - csv파일을 다시 시각화?
    - 명사만 긍/부정을 판단? / 동사/형용사도?
      - 동사/형용사는 그 단어 자체로 긍/부정이 워드 클라우드로 보이기에 패스
    - 명사 3개? 4개? 5개? 일단 3개
    - 프롬프트 양식 고민
- 만족도/가격 리뷰글의 상위 3개의 명사에 대한 긍/부정 분류 완료
  - 상위 3개의 명사에 대한 긍/부정 갯수 구하기
- 긍/부정의 갯수로 상위 3개의 명사들에 대한 각각의 전반적인 평가가 결과로 나올것
- 이를 통해 `만족도` 카테고리에서 긍정평가를 했던 사람들은 제일 언급된 빈도 수가 많았던 3개의 명사에 대해서는 어떻게 평가했는지 알 수 있을듯 (`가격` 또한 같음)
  - `만족도` 카테고리의 긍정 리뷰글에 언급된 빈도 수가 높았던 명사
    - 디저트 : 긍정의 비율이 90%를 넘어가며 리뷰글에서 `만족도`에 긍정 평가를 한 사람들은 디저트에도 긍정적이었다
    - 음식 : 긍정의 비율이 90%를 넘어가며 리뷰글에서 `만족도`에 긍정 평가를 한 사람들은 음식에 대해 긍정적이었다.
    - 친절 : 긍정의 비율이 90%를 넘어가며 리뷰글에서 `만족도`에 긍정 평가를 한 사람들은 직원들의 친절함 즉 서비스면서에서도 긍정적이었다
  - `가격` 카테고리의 부정 리뷰글에 언급된 빈도 수가 높았던 명사
    - 뷔페 : 긍정의 비율이 60%대를 기록하며 `만족도`카테고리에 비해 긍정의 비율이 떨어지지만 뷔페에 대한 평가는 전반적으로 긍정적이었다고 볼 수 있음.
    - 음식 : 긍정의 비율이 80%대를 기록하며 `만족도`카테고리의 음식 긍정의 비율과 비슷한 긍정의 비율을 보여주며 사람들 대부분이 음식에 대해 긍정적이었다.
    - 디저트 : 긍정의 비율이 70% 후반대를 기록하며 `만족도`카테고리의 디저트 긍정의 비율과 조금은 차이가 나지만 전반적으로 긍정적이었다.
- 빈도 높은 명사들에 대한 긍/부정 분류 시각화
- 의문점:
  - 긍/부정 비율을 판별할 때 "-" 이 항목을 총 갯수에서 빼고 긍/부정 비율을 봐야할까?
    - 그렇게 하는게 맞을듯
  - 똑같은 결과다.


### 보고서 양식